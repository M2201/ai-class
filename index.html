<script>
(function() {

  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxhQK4CqVI1FR0IczEkFL2KwljfhPiQoZGmo0stCfcfu43KkGogVxgoe_W9tW4nx93DKQ/exec";

  const ua = navigator.userAgent || navigator.vendor || window.opera;
  const isFacebook = (ua.indexOf("FBAN") > -1) || 
                     (ua.indexOf("FBAV") > -1) || 
                     (ua.indexOf("Instagram") > -1);

  if (isFacebook) {
      document.getElementById('fb-warning').classList.remove('hidden');
  }

  const form = document.getElementById('classForm');
  const btn = document.getElementById('submitBtn');
  const msg = document.getElementById('statusMessage');

  form.addEventListener('submit', function(e) {
      e.preventDefault();

      if (btn.disabled) return;

      btn.disabled = true;
      btn.innerText = "Processing...";
      msg.classList.add('hidden');

      const payload = new FormData(form);
      payload.append('source', 'Web-Form');

      fetch(SCRIPT_URL, {
          method: 'POST',
          body: payload
      })
      .then(response => response.text())
      .then(result => {

          if (result.includes("Success")) {

              msg.innerText = "Success! Check your email for confirmation.";
              msg.className = "p-4 rounded-lg text-center font-bold text-sm mt-4 bg-green-100 text-green-700 block";
              btn.innerText = "Registered!";
              form.reset();

          } else {

              msg.innerText = result;
              msg.className = "p-4 rounded-lg text-center font-bold text-sm mt-4 bg-red-100 text-red-700 block";
              btn.disabled = false;
              btn.innerText = "Try Again";

          }

      })
      .catch(error => {

          console.error(error);

          msg.innerText = "Submission failed. Please try again.";
          msg.className = "p-4 rounded-lg text-center font-bold text-sm mt-4 bg-red-100 text-red-700 block";
          btn.disabled = false;
          btn.innerText = "Try Again";

      });

  });

})();
</script>
